<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ page import="com.myweb.user.model.UserVO" %>
<%@ page import="com.myweb.user.model.UserDAO" %>
<%@ page import="java.io.PrintWriter" %>
<%
    request.setCharacterEncoding("UTF-8");

    // 폼 값을 받아옵니다.
    String id = request.getParameter("id");
    String name = request.getParameter("name");
    String email = request.getParameter("email");
    String address = request.getParameter("address");

    // 수정 결과를 저장할 변수
    int result = 0;

    // DAO 연동을 통해 회원 정보 수정
    UserDAO dao = UserDAO.getInstance();
    UserVO vo = new UserVO();
    vo.setId(id);
    vo.setName(name);
    vo.setEmail(email);
    vo.setAddress(address);
    result = dao.update(vo);

    // 응답 생성을 위한 PrintWriter 객체 생성
    response.setContentType("text/html; charset=UTF-8");
    PrintWriter out = response.getWriter();

    // 수정 성공 여부에 따라 메시지 출력
    if (result > 0) {
        // 수정 성공 시
        // 세션에 저장된 이름을 변경
        session.setAttribute("name", name);
        out.println("<script>alert('회원정보가 수정되었습니다.'); location.href='user_mypage.jsp';</script>");
    } else {
        // 수정 실패 시
        out.println("<script>alert('회원정보 수정에 실패했습니다.'); location.href='user_mypage.jsp';</script>");
    }
%>
